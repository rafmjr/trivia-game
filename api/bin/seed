#!/usr/bin/env node

require('../database');

const Activity = require('../models/Activity');
const Team = require('../models/Team');
const Result = require('../models/Result');

(async () => {
    // create stub activities
    await Promise.all(
        Object.entries({
            'If youve ordered a burn one, take it through the garden, pin a rose on it, what can you expect to be placed in front of you?': [
                'Hot Dog with Chili and Coleslaw',
                'Lamb Shish - Kabob',
                'Hamburger with Lettuce, Tomato and Onion',
                'Tuna Melt on Rye with Lettuce and Dill Chips',
            ],
            'Noahs Boy refers to a fish sandwich.': ['False', 'True'],
            'Due to the shape of its fruits, Aztecs called this tree Ahuacuatl, which meant testicle tree.': [],
        }).map(([question, answers]) => Activity.create({ question, answers }))
    );

    // create at least one team
    const team = await Team.create({ name: 'The Glorious Bastards' });

    // get one activity and solve it
    const activity = await Activity.findOne({ answers: { $ne: [] } });
    const result = await Result.create({
        activity: activity._id,
        solution: activity.answers[0],
    });

    // assign the result to the team
    team.results = [result._id];
    team.save();

    console.log('Done!');
    process.exit();
})();
